dashboard:
  enabled: false
  host: traefik.martinn.no
  entryPoints:
    - websecure
  certResolver: le

argocd:
  ingressRoute:
    enabled: true
    host: gitops.martinn.no
    entryPoints:
      - websecure
    middlewares: []
    service:
      name: argo-cd-argocd-server
      namespace: default
      port: 80
    tls:
      certResolver: le

traefik:
  # -- Email address used for Let's Encrypt registration. Replace with a valid mailbox before enabling in production.
  certificatesResolvers:
    le:
      acme:
        email: m4rtini89@gmail.com
        storage: /data/acme.json
        httpChallenge:
          entryPoint: web

  # -- Persist ACME certificates to survive pod restarts.
  persistence:
    enabled: true
    storageClass: local-path
    accessMode: ReadWriteOnce
    size: 1Gi
    path: /data

  # -- Expose Traefik via a LoadBalancer and redirect HTTP to HTTPS.
  service:
    type: LoadBalancer

  # -- Keep the API available; the dashboard route is managed separately and can be toggled via `.dashboard.enabled`.
  additionalArguments:
    - "--api=true"
    - "--api.dashboard=true"

  ports:
    web:
      expose:
        default: true
      redirections:
        entryPoint:
          to: websecure
          scheme: https
          permanent: true
    websecure:
      expose:
        default: true
      tls:
        enabled: true
        certResolver: le

  # -- Reduce log noise while keeping access logs available for troubleshooting.
  logs:
    general:
      level: WARN
    access:
      enabled: true

  # -- Leave the bundled dashboard route disabled; we manage exposure via a custom template.
  ingressRoute:
    dashboard:
      enabled: false

  # -- Disable phone-home checks since ArgoCD keeps chart upgrades under control.
  global:
    checkNewVersion: false
    sendAnonymousUsage: false
